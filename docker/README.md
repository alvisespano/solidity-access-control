# Title
​
Smart Contract Termination in Blockchain Systems: Kill Switches, Emergency Stops, Pausing, and Halting Mechanisms (Artifact)

## Overview: What does the artifact comprise?

* Dockerfile: file to build the docker contaner
* artifact.tar: the archive containing the data for docker container

### Content of the Docker container

* what type of artifact
	* scripts and file lists: scripts and data to automatize experimental evaluation
	* dataset: the dataset of files to analyze (Zellic 2023 Smart Contract Source Index)
	* results folder: reports generated after the script execution
* in which format
	* results:
		* Figures: .pdf (paper figures)
	* scripts and file lists:	
		* extract-sol-from-json: .py (to extract solidity files from json format on the dataset)
		* remove-sol-duplicates: .py (to remove duplicated solidity files on the dataset)
		* data-finder: .py (to reproduce paper results)
		* json-file-list: .txt (a pre-computed list of son file to analyze and extract solidity files)
		* sol-file-list: .txt (a pre-computed list of file to analyze without duplicates)
* can be found in which location
	* `/app/artifact/`

## Artifact Claims
​
* Which data or conclusions from the paper are generated/supported by the artifact components?
	* Reproduction of the raw results reported in the paper

* Which activities described in the paper have led to the creation of the artifact components?
	* Evaluation of existing Ethereum smart contracts

* What is the functionality/purpose of the artifact?
	* Reproduce the raw results of the paper
	* Provide a complete environment for analyzing the Ethereum smart contracts
​
## Getting Started

Build the docker container with the following command:

```
mkdir -p artifact
docker build --no-cache -t artifact-sc-access-control .
docker run -it -v ${PWD}/artifact:/app/artifact/results artifact-sc-access-control
```

## Within Docker Container

### Experimental Evaluation

For our experiments, we utilized the Zellic 2023 Smart Contract Source Index dataset (https://huggingface.co/datasets/Zellic/smart-contract-fiesta), which collects deployed smart contracts on the Ethereum mainnet as of block 16,860,349 (March 2023), with deduplicated source code entries based on the bytecode hash. 
From this dataset, we extracted the source code of the contracts, since EVM bytecode inherently removes high-level syntactic sugar such as contract imports, function bindings, and several instruction signatures. 
Contracts in the dataset are provided in three possible formats: single-file, multi-file, and Solidity Compiler JSON. In the first two cases, the source code is immediately available for our analysis. In the third case, the source code must be extracted from the JSON file.  To accomplish this, we applied a custom extraction script. After processing, we ensured the uniqueness of the dataset by removing duplicate contracts based on their hashes. It resulted in 181717 unique Solidity files. On the extracted source code, we applied regex-based analyses to identify specific patterns and structures for the study. 

### Walkthrough Step-by-step

Some steps are marked as optional because they allow you to generate the file list (for reproducibility). 
However, for simplicity, we have already provided these files.

1. (Optional) List all .json files in the dataset
	The dataset includes various .json files, some of which are Solidity Compiler JSON files containing data from Solidity source files.  A precomputed file list is available at `/app/artifact/json_file_list.txt`, but it can also be generated using the following command:

	```
	find smart-contract-fiesta -type f -name "*.json" >> json_file_list.txt
	```
	
2. Extract Solidity source files from Solidity Compiler JSON files
	The files can be extracted by running the following command:
	
	```
	python3 extract-sol-from-json.py json_file_list.txt
	```
	
3. (Optional) Remove duplicated Solidity source files
	Zellic 2023 Smart Contract Source Index guarantees no duplicated in EVM bytecode. However, the extraction of Solidity files add duplicated files. A precomputed file list od deduplicated Solidity source files is available at `/app/artifact/sol_file_list.txt` but it can also be generated using the following commands:

	```
	python3 remove-sol-duplicates smart-contract-fiesta
	find smart-contract-fiesta -type f -name "*.sol" >> sol_file_list.txt
	```
	
4. Generate data related to msg.sender checks
	it can be generated by running the following command:
	
	```
	python3 data-finder.py sol_file_list.txt SENDERCHECKS
	```
	
5. Generate data related access control patterns of OpenZeppelin
	It can be generated by running the following command:
	
	```
	python3 data-finder.py sol_file_list.txt OPZCONTRACTS
	```
	
